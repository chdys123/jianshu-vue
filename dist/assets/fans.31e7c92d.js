import{a9 as a,ac as e,T as t,S as s,ad as n,r as i,V as l,X as d,a4 as c,a5 as r,a7 as o,a2 as u,W as h,Z as m,_ as p,a0 as v,a1 as g,aa as f,o as C,a3 as D,$ as A}from"./vendor.2b14f918.js";import{_ as k}from"./index.420421d8.js";const x={setup(){let{proxy:i}=A(),l=a(),d=e("ec"),c=t(1),r=t(0),o=t(0);const u=()=>{i.http({method:"get",path:"/user/getFansData",params:{userId:l.state.user._id}}).then((a=>{200==a.code&&(r.value=a.data.data1,o.value=a.data.data2)}))};let h=s({title:{text:"粉丝趋势折线图"},color:["#3D89FF","#00C7C6"],tooltip:{trigger:"axis"},grid:{left:"50px",right:"50px"},legend:{data:["粉丝总数","粉丝变化数"]},xAxis:{boundaryGap:!1,data:[]},yAxis:{},series:[{name:"粉丝变化数",type:"line",data:[]},{name:"粉丝总数",type:"line",data:[]}]}),m=t();const p=()=>{m.value?(v.value=0,i.http({method:"get",path:"/user/getFansData",params:{userId:l.state.user._id,t1:Date.parse(m.value[0]),t2:Date.parse(m.value[1])}}).then((a=>{if(console.log(a.data),200==a.code){h.xAxis.data=f(m.value[0],m.value[1]),h.series[0].data.length=0,h.series[1].data.length=0,a.data.forEach((a=>{h.series[0].data.push(a.b),h.series[1].data.push(a.a)})),d.init(document.getElementById("FansQs")).setOption(h)}}))):console.log("时间清空")};let v=t(0);const g=async a=>{if(a==v.value)return;let e=new Date,t=e.getFullYear(),s=e.getMonth(),n=e.getDate(),i=new Date(t,s,n,0,0,0,0),l=[null,i];1==a?l[0]=new Date(Date.parse(i)-5184e5):2==a&&(l[0]=new Date(Date.parse(i)-25056e5)),m.value=l,await p(),v.value=a},f=(a,e)=>{let t=[],s=Date.parse(a),n=Date.parse(e);for(;s<=n;)t.push(`${(i=a).getFullYear()}-${i.getMonth()+1}-${i.getDate()}`),s+=864e5,a=new Date(s);var i;return t};let C=s([]);const D=()=>{i.http({method:"get",path:"/user/getFans",params:{userId:l.state.user._id,authorId:l.state.user._id}}).then((a=>{200==a.code&&C.push(...a.data)}))};return D(),u(),g(1),n((()=>{d.init(document.getElementById("FansQs")).setOption(h)})),{headerActiveItem:c,fansQsTime:m,getFansQs:p,fansQsActive:v,clickItem:g,fansChangeData:r,fansCount:o,getHxData:u,option:h,isDisable:a=>Date.parse(new Date)<Date.parse(a),getYearAndMonthAndDay:f,getFansList:D,fansList:C,careAndNoCare:(a,e,t)=>{i.http({method:"get",path:"/user/care",params:{userId:l.state.user._id,authorId:e,cate:t}}).then((e=>{200==e.code?C[a].isCare=!C[a].isCare:i.$message.error("服务器异常 稍后再试")}))}}}},I=a=>(v("data-v-c36cd158"),a=a(),g(),a),y={class:"fans-con"},F={class:"fans-con-header"},Q=I((()=>d("span",{class:"mach-fg"},null,-1))),b={class:"fans-con-body"},_=I((()=>d("div",{class:"hx-title"},"核心数据",-1))),w={class:"hx-Data-con"},$={class:"hx-data-item"},q=I((()=>d("div",{class:"hx-data-item-title"},"今日粉丝变化数",-1))),L={class:"hx-data-item-number"},T={class:"hx-data-item"},V=I((()=>d("div",{class:"hx-data-item-title"},"粉丝总数",-1))),E={class:"hx-data-item-number"},M=I((()=>d("div",{class:"qs-title"},"数据趋势",-1))),N={class:"qs-header-con"},Y=I((()=>d("span",{class:"qs-time-title"},"时间",-1))),j=I((()=>d("div",{id:"FansQs"},null,-1))),B={class:"fans-list"},O={class:"fans-list-title"},G=f(" 共 "),H=f("个粉丝 "),S={class:"fansList-con"},U=["onClick"],W=["src"],X=["onClick"],Z=["onClick"],z=["onClick"];var J=k(x,[["render",function(a,e,t,s,n,v){const g=i("el-date-picker");return C(),l("div",y,[d("div",F,[d("span",{class:c(["mach-work",{machActive:1==s.headerActiveItem}]),onClick:e[0]||(e[0]=a=>s.headerActiveItem=1)},"概况",2),Q,d("span",{class:c(["mach-cg",{machActive:2==s.headerActiveItem}]),onClick:e[1]||(e[1]=a=>s.headerActiveItem=2)},"粉丝列表",2)]),d("div",b,[r(d("div",null,[_,d("div",w,[d("div",$,[q,d("div",L,u(s.fansChangeData),1)]),d("div",T,[V,d("div",E,u(s.fansCount),1)])]),M,d("div",N,[Y,d("span",{class:c(["qs-time-item",{fansQsActiveItem:1==s.fansQsActive}]),onClick:e[2]||(e[2]=a=>s.clickItem(1))},"最近7天",2),d("span",{class:c(["qs-time-item",{fansQsActiveItem:2==s.fansQsActive}]),onClick:e[3]||(e[3]=a=>s.clickItem(2))},"最近30天",2),h(g,{modelValue:s.fansQsTime,"onUpdate:modelValue":e[4]||(e[4]=a=>s.fansQsTime=a),type:"daterange","range-separator":"~","start-placeholder":"开始日期","end-placeholder":"结束日期",onChange:e[5]||(e[5]=a=>s.getFansQs()),class:"picker",disabledDate:s.isDisable},null,8,["modelValue","disabledDate"])]),j],512),[[o,1==s.headerActiveItem]]),r(d("div",B,[d("div",O,[G,d("span",null,u(s.fansList.length),1),H]),d("div",S,[(C(!0),l(m,null,p(s.fansList,((e,t)=>(C(),l("div",{key:e.id,class:"fans-item"},[d("div",{class:"img-con",onClick:t=>a.$router.push("/authod?id="+e.id)},[d("img",{src:e.avatar,alt:""},null,8,W)],8,U),d("span",{class:"fans-username",onClick:t=>a.$router.push("/authod?id="+e.id)},u(e.username),9,X),e.isCare?D("",!0):(C(),l("button",{key:0,class:"noCare",onClick:a=>s.careAndNoCare(t,e.id,1)}," 关注 ",8,Z)),e.isCare?(C(),l("button",{key:1,class:"hasCare",onClick:a=>s.careAndNoCare(t,e.id,2)}," 已关注 ",8,z)):D("",!0)])))),128))])],512),[[o,2==s.headerActiveItem]])])])}],["__scopeId","data-v-c36cd158"]]);export{J as default};
